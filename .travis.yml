sudo: required
services:
- docker
cache: false
env:
  DOCKER_COMPOSE_VERSION: 1.13.0
before_install:
- sudo rm /usr/local/bin/docker-compose
- curl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname -s`-`uname -m` > docker-compose
- chmod +x docker-compose
- sudo mv docker-compose /usr/local/bin
install:
- docker-compose build
before_script:
- cd support/acceptance-testing
- docker-compose build
script:
- docker-compose run -v /tmp/reports:tmp/reports acceptance /bin/bash -c "gradle test; cp -Rf build/reports /tmp/"
notifications:
  webhooks:
    urls:
    - http://dev.redboxresearchdata.com.au/hooks/dockerhub
    on_success: always
    on_failure: never
    on_cancel: never
    on_error: never
before_deploy:
- ls /tmp/reports
deploy:
  provider: surge
  project: /tmp/reports
  domain: qcifengineering-acceptance-reports.surge.sh